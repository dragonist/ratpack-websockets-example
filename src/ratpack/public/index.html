<html>

    <head>
        <title>Ratpack Websockets Example</title>
        <script language="javascript" type="text/javascript" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
        <script language="javascript" type="text/javascript">
            var websocket;
            var ping;
            jQuery(function ($) {
                $('#connect').click(doConnect);
                $('#disconnect').click(doDisconnect);
                $('#send').click(function () {
                    doSend( $('#message').val() )
                });
                function doConnect() {
                    websocket = new WebSocket( "ws://localhost:5050/chat?client=" + $("#client").val() );
                    websocket.onopen = function (evt) {
                        onOpen(evt)
                    };
                    websocket.onclose = function (evt) {
                        onClose(evt)
                    };
                    websocket.onmessage = function (evt) {
                        onMessage(evt)
                    };
                    websocket.onerror = function (evt) {
                        onError(evt)
                    };
                }
                function doDisconnect() {
                    websocket.close();
                }
                function onOpen(evt) {
                    writeToScreen("CONNECTED");
                }
                function onClose(evt) {
                    writeToScreen("DISCONNECTED");
                }
                function onMessage(evt) {
                    writeToScreen('RECEIVED: ' + evt.data);
                }
                function onError(evt) {
                    writeToScreen('ERROR:' + evt.data);
                }
                function doSend(message) {
                    writeToScreen('SENT: ' + message);
                    websocket.send(message);
                }
                function writeToScreen(message) {
                    $('#output').append(message + '<br /><br />');
                }
            });
        </script>
    </head>

    <body>
        <h2>Ratpack Websockets Example</h2>

        <div id="connection">
            <input type="text" id="client" />
            <button id="connect">Connect</button>
            <button id="disconnect">Disconnect</button>
        </div>

        <div id="editor">
            <input type="text" id="message" />
            <button id="send">Send</button>
        </div>

        <div id="messages">

        </div>

    </body>

</html>